<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="NIGNX proxy in Kubernetes for Sendgrid SSL click Tracking" /><meta name="author" content="Mate Hajnal" /><meta property="og:locale" content="en" /><meta name="description" content="Before I get into the article I want to thank tg44 (Gergő Törcsvári) who created the final configuration, check his blog too if you have some time." /><meta property="og:description" content="Before I get into the article I want to thank tg44 (Gergő Törcsvári) who created the final configuration, check his blog too if you have some time." /><link rel="canonical" href="https://hajnalmt.hu/posts/kubernetes-sendgrid-service/" /><meta property="og:url" content="https://hajnalmt.hu/posts/kubernetes-sendgrid-service/" /><meta property="og:site_name" content="Hajnal Máté" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-03-15T00:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="NIGNX proxy in Kubernetes for Sendgrid SSL click Tracking" /><meta name="twitter:site" content="@hajnalmt" /><meta name="twitter:creator" content="@Mate Hajnal" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Mate Hajnal"},"dateModified":"2022-03-16T11:51:34+01:00","datePublished":"2022-03-15T00:00:00+01:00","description":"Before I get into the article I want to thank tg44 (Gergő Törcsvári) who created the final configuration, check his blog too if you have some time.","headline":"NIGNX proxy in Kubernetes for Sendgrid SSL click Tracking","mainEntityOfPage":{"@type":"WebPage","@id":"https://hajnalmt.hu/posts/kubernetes-sendgrid-service/"},"url":"https://hajnalmt.hu/posts/kubernetes-sendgrid-service/"}</script><title>NIGNX proxy in Kubernetes for Sendgrid SSL click Tracking | Hajnal Máté</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Hajnal Máté"><meta name="application-name" content="Hajnal Máté"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.notify(); } /* flipMode() */ } /* ModeToggle */ const modeToggle = new ModeToggle(); </script><body data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://raw.githubusercontent.com/hajnalmt/hajnalmt-blog/master/assets/profile_picture_cropped.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">Hajnal Máté</a></div><div class="site-subtitle font-italic">Just an engineer who likes coding, economics and political discussions.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about-me/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT ME</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://gitlab.com/hajnalmt" aria-label="gitlab" target="_blank" rel="noopener noreferrer"> <i class="fab fa-gitlab"></i> </a> <a href="https://github.com/hajnalmt" aria-label="github" target="_blank" rel="noopener noreferrer"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/hajnalmt" aria-label="twitter" target="_blank" rel="noopener noreferrer"> <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['hajnalmt','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>NIGNX proxy in Kubernetes for Sendgrid SSL click Tracking</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>NIGNX proxy in Kubernetes for Sendgrid SSL click Tracking</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1647298800" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Mar 15, 2022 </em> </span> <span> Updated <em class="" data-ts="1647427894" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Mar 16, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href=""></a> </em>, <em> <a href=""></a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="810 words"> <em>4 min</em> read</span></div></div></div><div class="post-content"><p>Before I get into the article I want to thank tg44 (Gergő Törcsvári) who created the final configuration, check <a href="https://tg44.github.io/">his blog</a> too if you have some time.</p><p>Sendgrid is an e-mail delivery service which my company is using to send e-mails. I won’t dive into its features, because its a quite common service, with great features, and a reasonable price.</p><blockquote class="prompt-info"><p>To understand this post you need to be familiar with Kubernetes, at least you need to know the concept of Ingresses and Services.</p></blockquote><h3 id="intro"><span class="mr-2">Intro</span><a href="#intro" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Last year we had a problem when we decieded to switch our Cluster from Rancher Cattle to Kubernetes. The e-mails contained https links, which we wanted to track (How many of them got clicked on etc.), and Sendgrid has an inbuilt feature called SSL click tracking, with a nice <a href="https://docs.sendgrid.com/ui/analytics-and-reporting/click-tracking-ssl">documentation</a>.</p><h3 id="basics"><span class="mr-2">Basics</span><a href="#basics" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>A normal click tracking can be set up with quite little knowledge, with an external domain (most of the cases), after the <a href="https://docs.sendgrid.com/ui/account-and-settings/how-to-set-up-domain-authentication">domain authentication</a> and the <a href="https://docs.sendgrid.com/ui/account-and-settings/how-to-set-up-link-branding">link branding</a> steps basically you are ready.</p><p>Although there are some <a href="https://docs.sendgrid.com/ui/analytics-and-reporting/click-tracking-html-best-practices">best pracices</a> you are better to follow.</p><h3 id="ssl-click-tracking"><span class="mr-2">SSL Click tracking</span><a href="#ssl-click-tracking" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>When we are speaking about SSL click tracking, we want to route the https links appropriately to the sendgrid server and than to us seemlessly. The than to us part is done by sendgrid itself, so we need to focus on the first one. The <a href="https://docs.sendgrid.com/ui/analytics-and-reporting/click-tracking-ssl">documentation</a> says to use CDN to manage the certificates, which is intriguing at least, and you need to pay for these services.</p><p>The second paragraph says that the other way is to setup a <a href="https://docs.sendgrid.com/ui/account-and-settings/custom-ssl-configurations">custom ssl configuration</a>, so I started to dive into it. So far when you set up the linkbranding you have already created the domain routing, with the CNAME domain entry setting: <code class="language-plaintext highlighter-rouge">urlxxxx.yourdoamin.com</code> to <code class="language-plaintext highlighter-rouge">sendgrid.net</code>. This is the url you will need into the upcoming tutorial. The task itself is to prepare a proxy which receives all the inbound traffic and forwards it to http://sendgrid.net or https://sendgrid.net in our case, which means in Kubernetes terms, to setup an ingress with a backend service.</p><h3 id="ingress-and-service"><span class="mr-2">Ingress and service</span><a href="#ingress-and-service" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>We use an <a href="https://kubernetes.github.io/ingress-nginx/">NGINX Ingress Controller</a> with a cert-manager ClusterIssuer in our Kubernetes cluster, and most of the time this will be your case too, but to create an ingress we need to have a service first which it can point to, so we are starting with that. This <a href="https://stackoverflow.com/questions/64705450/redirecting-traffic-to-external-url">stackoverflow post</a> is really helpful to understand all of this.</p><p>The Service just needs to forward traffic to an external DNS (sendgrid.net). Kubernetes has a solution for it, we can define an <a href="https://kubernetes.io/docs/concepts/services-networking/service/#externalname">ExternalName</a> type Service for this, which exactly does that.</p><p>So the Service will look like this.</p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Service</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">sendgrid-net</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">sengrid-proxy</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">ExternalName</span>
  <span class="na">externalName</span><span class="pi">:</span> <span class="s">sendgrid.net</span>
</pre></table></code></div></div><blockquote class="prompt-info"><p>You need to create the sendgrid-proxy namespace of course <code class="language-plaintext highlighter-rouge">kubectl create namespace sendgrid-proxy</code>, or edit the namespace part.</p></blockquote><p>Now we are able to create the ingress. It will look like this:</p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">networking.k8s.io/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Ingress</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">annotations</span><span class="pi">:</span>
    <span class="na">cert-manager.io/cluster-issuer</span><span class="pi">:</span> <span class="s">letsencypt-prod</span>
    <span class="na">nginx.ingress.kubernetes.io/proxy-body-size</span><span class="pi">:</span> <span class="s2">"</span><span class="s">0"</span>
    <span class="na">nginx.ingress.kubernetes.io/ssl-redirect</span><span class="pi">:</span> <span class="s2">"</span><span class="s">true"</span>
    <span class="na">nginx.ingress.kubernetes.io/upstream-vhost</span><span class="pi">:</span> <span class="s2">"</span><span class="s">urlxxxx.yourdoamin.com"</span>
    <span class="na">nginx.ingress.kubernetes.io/backend-protocol</span><span class="pi">:</span> <span class="s2">"</span><span class="s">HTTPS"</span>
    <span class="na">kubernetes.io/ingress.class</span><span class="pi">:</span> <span class="s2">"</span><span class="s">nginx"</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">sendgrid</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">sengrid-proxy</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">rules</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">host</span><span class="pi">:</span> <span class="s">urlxxxx.yourdoamin.com</span>
      <span class="na">http</span><span class="pi">:</span>
        <span class="na">paths</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">backend</span><span class="pi">:</span>
              <span class="na">service</span><span class="pi">:</span>
                <span class="na">name</span><span class="pi">:</span> <span class="s">sendgrid-net</span>
                <span class="na">port</span><span class="pi">:</span>
                  <span class="na">number</span><span class="pi">:</span> <span class="m">443</span>
            <span class="na">path</span><span class="pi">:</span> <span class="s">/</span>
            <span class="na">pathType</span><span class="pi">:</span> <span class="s">ImplementationSpecific</span>
  <span class="na">tls</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">hosts</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="s">urlxxxx.yourdoamin.com</span>
      <span class="na">secretName</span><span class="pi">:</span> <span class="s">urlxxxx.yourdoamin.com</span>
</pre></table></code></div></div><p>This ingress uses the letsencypt-prod cert-manager, which can of course differ in your cluster, but apart from that, you need to edit the <code class="language-plaintext highlighter-rouge">urlxxxx.yourdoamin.com</code> lines only.</p><p>Regarding about the nginx configuration the <a href="https://kubernetes.github.io/ingress-nginx/user-guide/nginx-configuration/annotations/#custom-nginx-upstream-vhost">upstream-vhost</a> annotation sets the <code class="language-plaintext highlighter-rouge">proxy_set_header Host $host</code> directive, which was pointed out in the <a href="https://docs.sendgrid.com/ui/account-and-settings/custom-ssl-configurations">sendgrid documentation</a> that its needed.</p><p>The <a href="https://kubernetes.github.io/ingress-nginx/user-guide/nginx-configuration/annotations/#custom-max-body-size">proxy-body-size</a> annotation will set the <a href="http://nginx.org/en/docs/http/ngx_http_core_module.html#client_max_body_size">client_max_body_size</a> nginx directive, which means that there won’t be any size checking on the requests. Furthermore the SSL redirection, and the https backend protocol annotations will ensure the HTTPS connection between the ingress and the Backend service.</p><p>The final applicable one-file configuration is the following:</p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre><td class="rouge-code"><pre><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Namespace</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">sengrid-proxy</span>
<span class="nn">---</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Service</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">sendgrid-net</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">sengrid-proxy</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">ExternalName</span>
  <span class="na">externalName</span><span class="pi">:</span> <span class="s">sendgrid.net</span>
<span class="nn">---</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">networking.k8s.io/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Ingress</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">annotations</span><span class="pi">:</span>
    <span class="na">cert-manager.io/cluster-issuer</span><span class="pi">:</span> <span class="s">letsencypt-prod</span>
    <span class="na">nginx.ingress.kubernetes.io/proxy-body-size</span><span class="pi">:</span> <span class="s2">"</span><span class="s">0"</span>
    <span class="na">nginx.ingress.kubernetes.io/ssl-redirect</span><span class="pi">:</span> <span class="s2">"</span><span class="s">true"</span>
    <span class="na">nginx.ingress.kubernetes.io/upstream-vhost</span><span class="pi">:</span> <span class="s2">"</span><span class="s">urlxxxx.yourdoamin.com"</span>
    <span class="na">nginx.ingress.kubernetes.io/backend-protocol</span><span class="pi">:</span> <span class="s2">"</span><span class="s">HTTPS"</span>
    <span class="na">kubernetes.io/ingress.class</span><span class="pi">:</span> <span class="s2">"</span><span class="s">nginx"</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">sendgrid</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">sengrid-proxy</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">rules</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">host</span><span class="pi">:</span> <span class="s">urlxxxx.yourdoamin.com</span>
      <span class="na">http</span><span class="pi">:</span>
        <span class="na">paths</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">backend</span><span class="pi">:</span>
              <span class="na">service</span><span class="pi">:</span>
                <span class="na">name</span><span class="pi">:</span> <span class="s">sendgrid-net</span>
                <span class="na">port</span><span class="pi">:</span>
                  <span class="na">number</span><span class="pi">:</span> <span class="m">443</span>
            <span class="na">path</span><span class="pi">:</span> <span class="s">/</span>
            <span class="na">pathType</span><span class="pi">:</span> <span class="s">ImplementationSpecific</span>
  <span class="na">tls</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">hosts</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="s">urlxxxx.yourdoamin.com</span>
      <span class="na">secretName</span><span class="pi">:</span> <span class="s">urlxxxx.yourdoamin.com</span>
</pre></table></code></div></div><p>With this configuration you will be able to create any external dns proxy in your Kubernetes Cluster too, so I hope this helps!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/blogging/'>Blogging</a>, <a href='/categories/cv/'>CV</a>, <a href='/categories/writing/'>Writing</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/sendgrid/" class="post-tag no-text-decoration" >sendgrid</a> <a href="/tags/ssltracking/" class="post-tag no-text-decoration" >ssltracking</a> <a href="/tags/ssl/" class="post-tag no-text-decoration" >ssl</a> <a href="/tags/clicktracking/" class="post-tag no-text-decoration" >clicktracking</a> <a href="/tags/kubernetes/" class="post-tag no-text-decoration" >kubernetes</a> <a href="/tags/ingress/" class="post-tag no-text-decoration" >ingress</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=NIGNX%20proxy%20in%20Kubernetes%20for%20Sendgrid%20SSL%20click%20Tracking%20-%20Hajnal%20M%C3%A1t%C3%A9&url=https%3A%2F%2Fhajnalmt.hu%2Fposts%2Fkubernetes-sendgrid-service%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=NIGNX%20proxy%20in%20Kubernetes%20for%20Sendgrid%20SSL%20click%20Tracking%20-%20Hajnal%20M%C3%A1t%C3%A9&u=https%3A%2F%2Fhajnalmt.hu%2Fposts%2Fkubernetes-sendgrid-service%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fhajnalmt.hu%2Fposts%2Fkubernetes-sendgrid-service%2F&text=NIGNX%20proxy%20in%20Kubernetes%20for%20Sendgrid%20SSL%20click%20Tracking%20-%20Hajnal%20M%C3%A1t%C3%A9" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/laravel-sail-setup-intricacies/">The intricacies of a laravel project setup with sail under WSL2</a><li><a href="/posts/how-to-write-a-modern-classic.cv/">How to write a cv in latex with moderncv template</a><li><a href="/posts/kubernetes-sendgrid-service/">NIGNX proxy in Kubernetes for Sendgrid SSL click Tracking</a><li><a href="/posts/about-my-blog/">Starting at somewhere</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/writing/">writing</a> <a class="post-tag" href="/tags/clicktracking/">clicktracking</a> <a class="post-tag" href="/tags/cv/">cv</a> <a class="post-tag" href="/tags/dns/">dns</a> <a class="post-tag" href="/tags/dnsproblem/">dnsproblem</a> <a class="post-tag" href="/tags/gitlabicon/">gitlabicon</a> <a class="post-tag" href="/tags/ingress/">ingress</a> <a class="post-tag" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag" href="/tags/laravel/">laravel</a> <a class="post-tag" href="/tags/latex/">latex</a></div></div></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/how-to-write-a-modern-classic.cv/"><div class="card-body"> <em class="small" data-ts="1647039600" data-df="ll" > Mar 12, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>How to write a cv in latex with moderncv template</h3><div class="text-muted small"><p> TLDR: Here is my new CV written in latex: English CV Hungarian CV The source code link on Overleaf: Hajnal Mate CV. Intro Today I stumbled upon the task to refresh my CV and I decided tha...</p></div></div></a></div><div class="card"> <a href="/posts/about-my-blog/"><div class="card-body"> <em class="small" data-ts="1645570800" data-df="ll" > Feb 23, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Starting at somewhere</h3><div class="text-muted small"><p> By the time most of the developers feel like, that it would be really cool, to share their thoughts online about the stuff they deal with every day. This happened to be the case with me too, so I s...</p></div></div></a></div><div class="card"> <a href="/posts/laravel-sail-setup-intricacies/"><div class="card-body"> <em class="small" data-ts="1648591200" data-df="ll" > Mar 30, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>The intricacies of a laravel project setup with sail under WSL2</h3><div class="text-muted small"><p> I needed to create a laravel blog motor for one of my interviews in the past 2 weeks, and even to just get started I bumped into some problems. To be a little bit more specific, the problem was tha...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/how-to-write-a-modern-classic.cv/" class="btn btn-outline-primary" prompt="Older"><p>How to write a cv in latex with moderncv template</p></a> <a href="/posts/laravel-sail-setup-intricacies/" class="btn btn-outline-primary" prompt="Newer"><p>The intricacies of a laravel project setup with sail under WSL2</p></a></div></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/writing/">writing</a> <a class="post-tag" href="/tags/clicktracking/">clicktracking</a> <a class="post-tag" href="/tags/cv/">cv</a> <a class="post-tag" href="/tags/dns/">dns</a> <a class="post-tag" href="/tags/dnsproblem/">dnsproblem</a> <a class="post-tag" href="/tags/gitlabicon/">gitlabicon</a> <a class="post-tag" href="/tags/ingress/">ingress</a> <a class="post-tag" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag" href="/tags/laravel/">laravel</a> <a class="post-tag" href="/tags/latex/">latex</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/hajnalmt">Hajnal Máté</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/unregister.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-GNGCDNSM4P"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-GNGCDNSM4P'); }); </script>
